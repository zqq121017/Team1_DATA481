---
title: "481richard1"
output: html_document
date: "2026-01-15"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
library(tidyverse)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
raw_data <- read_csv("https://raw.githubusercontent.com/fivethirtyeight/superbowl-ads/main/superbowl-ads.csv")
head(raw_data)
names(raw_data)
```
```{r}
mean(raw_data$`funny` == TRUE, na.rm = TRUE)
mean(raw_data$`patriotic` == TRUE, na.rm = TRUE)
mean(raw_data$`use_sex` == TRUE, na.rm = TRUE)

tab <- table(raw_data$brand)
mode_brand <- names(tab)[which.max(tab)]
mode_freq  <- max(tab)
mode_brand
mode_freq

```
```{r}
props <- data.frame(
  feature = c("funny", "patriotic", "use_sex"),
  proportion = c(
    mean(raw_data$funny, na.rm = TRUE),
    mean(raw_data$patriotic, na.rm = TRUE),
    mean(raw_data$use_sex, na.rm = TRUE)
  )
)
library(ggplot2)

ggplot(props, aes(x = feature, y = proportion)) +
  geom_col() +
  ylim(0, 1) +
  labs(
    title = "Proportion of TRUE Values by Feature",
    y = "Proportion",
    x = "Feature"
  ) +
  theme_minimal()

```
```{r}
long_data <- raw_data %>%
  pivot_longer(
    cols = c(celebrity, funny, patriotic, show_product_quickly),
    names_to = "feature",
    values_to = "present"
  ) %>%
  group_by(year, feature) %>%
  summarise(
    proportion = mean(present, na.rm = TRUE),
    .groups = "drop"
  )

```
```{r}
ggplot(long_data, aes(x = year, y = proportion, color = feature)) +
  geom_line(linewidth = 1) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Shifts in Advertising Focus Over Time",
    x = "Year",
    y = "Percentage of Ads with Feature",
    color = "Feature"
  ) +
  theme_minimal()

```
```{r}
rank_data <- long_data %>%
  group_by(year) %>%
  mutate(rank = rank(-proportion, ties.method = "first"))

ggplot(rank_data, aes(x = year, y = rank, color = feature)) +
  geom_line(linewidth = 1.2) +
  scale_y_reverse(breaks = 1:4) +
  labs(
    title = "Relative Importance of Ad Features Over Time",
    x = "Year",
    y = "Rank (1 = Most Common)",
    color = "Feature"
  ) +
  theme_minimal()

```



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
